<!DOCTYPE html>
<html>
<head>
    <title>Documents Form</title>
</head>
<body>
    <h3>Documents Form</h3>

    <!-- Add Document Form -->
    <form id="add-document-form">
        <input type="text" name="title" placeholder="Document Title" required>
        <input type="text" name="file_path" placeholder="File Path">
        <input type="datetime-local" name="uploaded_date" placeholder="Upload Date">
        <button type="submit">Add Document</button>
    </form>

    <h4>Document List</h4>
    <ul id="document-list"></ul>

    <!-- ========================= -->
    <!-- Add your POST, PUT, DELETE fetch code -->
    <!-- ========================= -->
    <script>
    function loadDocuments() {
        fetch('/api/documents/')
            .then(response => response.json())
            .then(data => {
                const list = document.getElementById('document-list');
                list.innerHTML = '';
                data.forEach(document => {
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <strong>${document.title}</strong> - ${document.file_path || ''} (${document.uploaded_date || 'N/A'})
                        <button onclick="editDocument(${document.id}, '${document.title}', '${document.file_path || ''}', '${document.uploaded_date || ''}')">Edit</button>
                        <button onclick="deleteDocument(${document.id})">Delete</button>
                    `;
                    list.appendChild(li);
                });
            });
    }

    // POST: Add a new document
    document.getElementById('add-document-form').onsubmit = function(e) {
        e.preventDefault();
        const form = e.target;
        fetch('/api/documents/', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                title: form.title.value,
                file_path: form.file_path.value,
                uploaded_date: form.uploaded_date.value
            })
        })
        .then(response => response.json())
        .then(data => {
            alert('Document added: ' + data.title);
            form.reset();
            loadDocuments();
        });
    };

    // PUT: Edit an existing document
    function editDocument(id, currentTitle, currentFilePath, currentUploadedDate) {
        const title = prompt("Edit title:", currentTitle);
        if (title === null) return;
        const file_path = prompt("Edit file path:", currentFilePath);
        const uploaded_date = prompt("Edit uploaded date (YYYY-MM-DDTHH:MM):", currentUploadedDate);
        fetch(`/api/documents/${id}`, {
            method: 'PUT',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({title, file_path, uploaded_date})
        })
        .then(response => response.json())
        .then(data => {
            alert('Document updated: ' + data.title);
            loadDocuments();
        });
    }

    // DELETE: Remove a document
    function deleteDocument(id) {
        if (!confirm("Are you sure you want to delete this document?")) return;
        fetch(`/api/documents/${id}`, {
            method: 'DELETE'
        })
        .then(response => response.json())
        .then(data => {
            alert(data.detail);
            loadDocuments();
        });
    }

    // Initial load
    loadDocuments();
    </script>
    <!-- ========================= -->
    <!-- End of POST, PUT, DELETE fetch code -->
    <!-- ========================= -->

</body>
</html>
